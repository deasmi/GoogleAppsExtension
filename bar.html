<!DOCTYPE html>
<html>
<head>
<title>Google Apps Bar</title>
<link rel="stylesheet" type="text/css" href="barstyle.css">
<script>


safari.extension.settings.addEventListener("change",prefsChanged,false);



var applicationNames=["Mail","Calender","Docs","Manage"]
var applicationURLs=["http://mail.google.com/a/-domain-/","http://www.google.com/calendar/hosted/-domain-","http://docs.google.com/a/-domain-","http://www.google.com/a/-domain-"]


function prefsChanged()
{
	renderBar();
}



function renderBar()
{
	var domainList = safari.extension.settings.getItem("domainList").split(',');
	
	
    var listDiv = document.getElementById('googleAppsList');
	var newList = "";
	if (domainList.length > 0 && domainList[0].length > 0) {

	for (var i=0; i<domainList.length; i++){
		if (i!=0) newList = newList + "&nbsp;|&nbsp;&nbsp;"
		newList = newList + "<em>" + domainList[i] + "</em>&nbsp;";
		for (var j=0; j<applicationNames.length; j++){
			var url = applicationURLs[j].replace(/-domain-/,domainList[i]);
			newList = newList + "<a href=\"" + url + "\">" + applicationNames[j] + "</a>";
		}
	}
} else {
	newList = "Please set your domain(s) in the extensions preferences...."
	
}
listDiv.innerHTML=newList;

}


 




</script>
</head>
<body id="bar" onload="renderBar();">
<div id="googleAppsList"></div>
<p>Ha ha ha</p>
</body>
</html>